<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>5:00 Countdown</title>
  <style>
    :root { --bg:#0f172a; --fg:#e2e8f0; --accent:#38bdf8; --muted:#94a3b8; --danger:#f43f5e; }
    * { box-sizing: border-box; }
    body {
      margin: 0; min-height: 100svh; display: grid; place-items: center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 50% 20%, #0b1223, var(--bg));
      color: var(--fg);
    }
    .card {
      width: min(560px, 92vw); padding: 28px 24px; border-radius: 20px;
      background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 10px 30px rgba(0,0,0,0.35); backdrop-filter: blur(6px);
      text-align: center;
    }
    h1 { margin: 0 0 8px; font-size: clamp(18px, 2.5vw, 22px); color: var(--muted); font-weight: 600; letter-spacing: .3px; }
    #time {
      font-variant-numeric: tabular-nums; letter-spacing: 1px;
      font-size: clamp(56px, 12vw, 132px); line-height: 1; margin: 8px 0 16px;
      font-weight: 800; color: var(--fg); text-shadow: 0 4px 18px rgba(56,189,248,0.12);
    }
    .controls { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-top: 8px; }
    button {
      padding: 12px 16px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.12);
      background: rgba(56,189,248,0.12); color: var(--fg); cursor: pointer; font-weight: 600;
      transition: transform .06s ease, background .2s ease, border-color .2s;
    }
    button:hover { transform: translateY(-1px); background: rgba(56,189,248,0.18); }
    button:active { transform: translateY(0); }
    .secondary { background: rgba(148,163,184,0.12); }
    .secondary:hover { background: rgba(148,163,184,0.18); }
    .danger { background: rgba(244,63,94,0.14); border-color: rgba(244,63,94,0.35); }
    .danger:hover { background: rgba(244,63,94,0.2); }
    .ring {
      width: clamp(200px, 42vw, 360px); aspect-ratio: 1/1; margin: 12px auto 0; position: relative;
    }
    .ring svg { width: 100%; height: 100%; transform: rotate(-90deg); }
    .ring circle.track { stroke: rgba(148,163,184,0.25); }
    .ring circle.progress { stroke: var(--accent); transition: stroke-dashoffset .25s linear; filter: drop-shadow(0 0 10px rgba(56,189,248,0.25)); }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
    .done { color: var(--danger); animation: pulse 1s steps(2,end) 8; }
    @keyframes pulse { 50% { opacity: .45 } }
  </style>
</head>
<body>
  <main class="card" role="region" aria-label="Countdown timer">
    <h1>Countdown</h1>

    <!-- Progress Ring -->
    <div class="ring" aria-hidden="true">
      <svg viewBox="0 0 120 120">
        <circle class="track" cx="60" cy="60" r="54" fill="none" stroke-width="8" />
        <circle class="progress" id="ringProgress" cx="60" cy="60" r="54" fill="none" stroke-width="8"
                stroke-linecap="round" stroke-dasharray="339.292" stroke-dashoffset="0" />
      </svg>
    </div>

    <!-- Time -->
    <div id="time" aria-live="polite" aria-atomic="true">05:00</div>
    <div class="sr-only" id="a11y-status">5 minutes remaining</div>

    <div class="controls">
      <button id="pauseBtn" class="secondary" type="button" aria-pressed="false">Pause</button>
      <button id="resetBtn" class="danger" type="button">Reset</button>
    </div>
  </main>

  <script>
    // ===== Config =====
    const START_SECONDS = 5 * 60; // 5 minutes

    // ===== State =====
    let remaining = START_SECONDS;
    let ticking = null;
    let lastTick = null;
    let audioCtx = null;

    const timeEl = document.getElementById('time');
    const a11yEl = document.getElementById('a11y-status');
    const pauseBtn = document.getElementById('pauseBtn');
    const resetBtn = document.getElementById('resetBtn');
    const ring = document.getElementById('ringProgress');
    const circumference = 2 * Math.PI * 54; // matches stroke-dasharray above

    function fmt(sec) {
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    }

    function updateUI() {
      timeEl.textContent = fmt(remaining);
      document.title = `${fmt(remaining)} Countdown`;
      a11yEl.textContent = `${Math.floor(remaining/60)} minute${Math.floor(remaining/60)===1?'':'s'} ${Math.floor(remaining%60)} second${Math.floor(remaining%60)===1?'':'s'} remaining`;

      // ring progress (0 at start, full when zero)
      const fraction = 1 - (remaining / START_SECONDS);
      ring.style.strokeDasharray = circumference.toFixed(3);
      ring.style.strokeDashoffset = (circumference * fraction).toFixed(3);
    }

    function tick(now) {
      if (!lastTick) lastTick = now;
      const delta = (now - lastTick) / 1000; // seconds since last frame
      lastTick = now;

      remaining = Math.max(0, remaining - delta);
      updateUI();

      if (remaining <= 0) {
        stop();
        doneEffects();
        return;
      }
      ticking = requestAnimationFrame(tick);
    }

    function start() {
      if (ticking) return;
      lastTick = performance.now();
      ticking = requestAnimationFrame(tick);
      pauseBtn.textContent = 'Pause';
      pauseBtn.setAttribute('aria-pressed', 'false');
      timeEl.classList.remove('done');
    }

    function stop() {
      if (ticking) cancelAnimationFrame(ticking);
      ticking = null;
    }

    function reset() {
      stop();
      remaining = START_SECONDS;
      updateUI();
      timeEl.classList.remove('done');
      start();
    }

    function togglePause() {
      if (ticking) {
        stop();
        pauseBtn.textContent = 'Resume';
        pauseBtn.setAttribute('aria-pressed', 'true');
      } else {
        start();
      }
    }

    function doneEffects() {
      timeEl.classList.add('done');
      document.title = 'Timeâ€™s up!';
      a11yEl.textContent = 'Time is up';
      beep();
    }

    function beep() {
      try {
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = 'sine';
        o.frequency.value = 880;
        g.gain.value = 0.001; // start quiet to avoid clicks
        o.connect(g).connect(audioCtx.destination);
        o.start();

        // quick envelope
        g.gain.exponentialRampToValueAtTime(0.1, audioCtx.currentTime + 0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.35);
        o.stop(audioCtx.currentTime + 0.4);
      } catch (e) { /* ignore if blocked */ }
    }

    // Visibility handling: pause when tab hidden, resume when visible (optional)
    document.addEventListener('visibilitychange', () => {
      if (document.hidden && ticking) stop();
      else if (!document.hidden && remaining > 0) start();
    });

    // Controls
    pauseBtn.addEventListener('click', togglePause);
    resetBtn.addEventListener('click', reset);

    // Kick off
    updateUI();
    start();
  </script>
</body>
</html>
